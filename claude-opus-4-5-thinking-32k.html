<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saharsh Life</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Nunito:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: white;
            overflow: hidden;
        }
        
        #game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        /* Menu Screen */
        #menu-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            z-index: 100;
        }
        
        #menu-screen h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: 3rem;
            color: #ff6b6b;
            text-shadow: 4px 4px 0 #4ecdc4, 8px 8px 0 rgba(0,0,0,0.3);
            margin-bottom: 20px;
            animation: titlePulse 2s infinite;
        }
        
        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .menu-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 5px solid #4ecdc4;
            margin: 20px;
            object-fit: cover;
            box-shadow: 0 0 30px rgba(78, 205, 196, 0.5);
        }
        
        .menu-btn {
            font-family: 'Press Start 2P', cursive;
            font-size: 1rem;
            padding: 20px 40px;
            margin: 10px;
            background: linear-gradient(145deg, #ff6b6b, #ee5a5a);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 0 #c44;
        }
        
        .menu-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #c44;
        }
        
        .menu-btn:active {
            transform: translateY(3px);
            box-shadow: 0 3px 0 #c44;
        }
        
        /* Game Screen */
        #game-screen {
            display: none;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        /* Stats Bar */
        #stats-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 15px 20px;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 50;
            border-bottom: 3px solid #4ecdc4;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 100px;
        }
        
        .stat-label {
            font-size: 0.7rem;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .stat-bar {
            width: 80px;
            height: 12px;
            background: #333;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .stat-fill {
            height: 100%;
            transition: width 0.5s, background 0.3s;
            border-radius: 6px;
        }
        
        .stat-fill.grades { background: linear-gradient(90deg, #ff6b6b, #feca57); }
        .stat-fill.energy { background: linear-gradient(90deg, #5f27cd, #a55eea); }
        .stat-fill.fun { background: linear-gradient(90deg, #00d2d3, #54a0ff); }
        .stat-fill.reputation { background: linear-gradient(90deg, #10ac84, #1dd1a1); }
        
        #day-display {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            color: #feca57;
        }
        
        /* Main Game Area */
        #game-area {
            position: absolute;
            top: 70px;
            left: 0;
            right: 0;
            bottom: 100px;
            display: flex;
        }
        
        /* Location Display */
        #location-area {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }
        
        #location-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.3;
            background-size: cover;
            background-position: center;
        }
        
        #location-name {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            color: #4ecdc4;
            margin-bottom: 20px;
            z-index: 10;
        }
        
        #character-display {
            position: relative;
            z-index: 10;
        }
        
        #character-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #ff6b6b;
            object-fit: cover;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        #character-status {
            background: rgba(0,0,0,0.7);
            padding: 10px 20px;
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        /* Actions Panel */
        #actions-panel {
            flex: 1;
            background: rgba(0,0,0,0.5);
            padding: 20px;
            overflow-y: auto;
            border-left: 2px solid #4ecdc4;
        }
        
        #actions-panel h3 {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            color: #feca57;
            margin-bottom: 15px;
        }
        
        .action-btn {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background: linear-gradient(145deg, #2d3436, #636e72);
            border: 2px solid #4ecdc4;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 0.9rem;
        }
        
        .action-btn:hover {
            background: linear-gradient(145deg, #4ecdc4, #00cec9);
            transform: translateX(5px);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .action-cost {
            font-size: 0.7rem;
            color: #feca57;
            display: block;
            margin-top: 5px;
        }
        
        /* Event Log */
        #event-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: rgba(0,0,0,0.9);
            border-top: 3px solid #ff6b6b;
            padding: 15px 20px;
            overflow-y: auto;
        }
        
        #event-log {
            font-size: 0.85rem;
            line-height: 1.6;
        }
        
        .event-entry {
            padding: 5px 0;
            border-bottom: 1px solid #333;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .event-good { color: #1dd1a1; }
        .event-bad { color: #ff6b6b; }
        .event-neutral { color: #feca57; }
        
        /* Mini Game - SecurCentrix */
        #mini-game-overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        #mini-game-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            color: #00ff88;
            margin-bottom: 20px;
            text-shadow: 0 0 20px #00ff88;
        }
        
        #mini-game-canvas {
            border: 3px solid #00ff88;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0,255,136,0.3);
        }
        
        #mini-game-ui {
            margin-top: 20px;
            display: flex;
            gap: 30px;
        }
        
        .mini-stat {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            color: #00ff88;
        }
        
        #exit-mini-game {
            margin-top: 20px;
            padding: 10px 30px;
            background: #ff6b6b;
            border: none;
            border-radius: 5px;
            color: white;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
        }
        
        /* Game Over */
        #game-over-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 300;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        #game-over-screen h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 2rem;
            margin-bottom: 30px;
        }
        
        #game-over-message {
            font-size: 1.2rem;
            margin-bottom: 30px;
            text-align: center;
            max-width: 500px;
        }
        
        /* NPCs */
        .npc-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
            z-index: 10;
        }
        
        .npc {
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .npc:hover {
            transform: scale(1.1);
        }
        
        .npc-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(145deg, #636e72, #2d3436);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border: 3px solid #4ecdc4;
        }
        
        .npc-name {
            font-size: 0.7rem;
            margin-top: 5px;
            color: #aaa;
        }
        
        /* Dialog Box */
        #dialog-box {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #2d3436, #1a1a2e);
            border: 3px solid #ff6b6b;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            z-index: 250;
            text-align: center;
        }
        
        #dialog-text {
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .dialog-btn {
            padding: 10px 25px;
            margin: 5px;
            background: #4ecdc4;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .dialog-btn:hover {
            background: #00cec9;
            transform: scale(1.05);
        }
        
        .dialog-btn.bad {
            background: #ff6b6b;
        }
        
        /* Notifications */
        #notification {
            display: none;
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(145deg, #ff6b6b, #ee5a5a);
            padding: 15px 30px;
            border-radius: 10px;
            z-index: 200;
            font-size: 1rem;
            animation: slideDown 0.5s;
        }
        
        @keyframes slideDown {
            from { top: 50px; opacity: 0; }
            to { top: 100px; opacity: 1; }
        }
        
        /* Location Buttons */
        #location-nav {
            position: absolute;
            bottom: 110px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 60;
        }
        
        .loc-btn {
            padding: 10px 20px;
            background: rgba(0,0,0,0.7);
            border: 2px solid #4ecdc4;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .loc-btn:hover, .loc-btn.active {
            background: #4ecdc4;
            color: #1a1a2e;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Menu Screen -->
        <div id="menu-screen">
            <h1>SAHARSH LIFE</h1>
            <img src="https://asset-cdn.schoology.com/system/files/imagecache/profile_big/pictures/picture-c0b09cdead19788fb0f8be0d53b5c572_68c34cd700b90.jpg" 
                 alt="Saharsh" class="menu-avatar" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2245%22 fill=%22%234ecdc4%22/><text x=%2250%22 y=%2265%22 text-anchor=%22middle%22 font-size=%2240%22>üßë</text></svg>'">
            <p style="margin: 10px 0 30px; color: #aaa; font-size: 0.9rem;">Survive high school as Saharsh!</p>
            <button class="menu-btn" onclick="startGame()">START GAME</button>
            <p style="margin-top: 40px; color: #666; font-size: 0.7rem;">Fail classes ‚Ä¢ Get bullied ‚Ä¢ Play games ‚Ä¢ Annoy everyone</p>
        </div>
        
        <!-- Game Screen -->
        <div id="game-screen">
            <!-- Stats Bar -->
            <div id="stats-bar">
                <div class="stat">
                    <span class="stat-label">üìö GRADES</span>
                    <div class="stat-bar"><div id="grades-fill" class="stat-fill grades" style="width: 30%"></div></div>
                </div>
                <div class="stat">
                    <span class="stat-label">‚ö° ENERGY</span>
                    <div class="stat-bar"><div id="energy-fill" class="stat-fill energy" style="width: 100%"></div></div>
                </div>
                <div class="stat">
                    <span class="stat-label">üéÆ FUN</span>
                    <div class="stat-bar"><div id="fun-fill" class="stat-fill fun" style="width: 50%"></div></div>
                </div>
                <div class="stat">
                    <span class="stat-label">‚≠ê REPUTATION</span>
                    <div class="stat-bar"><div id="rep-fill" class="stat-fill reputation" style="width: 50%"></div></div>
                </div>
                <div id="day-display">DAY 1 - MONDAY</div>
            </div>
            
            <!-- Main Game Area -->
            <div id="game-area">
                <div id="location-area">
                    <div id="location-bg"></div>
                    <h2 id="location-name">üìö CLASSROOM</h2>
                    <div id="character-display">
                        <img id="character-avatar" src="https://asset-cdn.schoology.com/system/files/imagecache/profile_big/pictures/picture-c0b09cdead19788fb0f8be0d53b5c572_68c34cd700b90.jpg" 
                             alt="Saharsh" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2245%22 fill=%22%234ecdc4%22/><text x=%2250%22 y=%2265%22 text-anchor=%22middle%22 font-size=%2240%22>üßë</text></svg>'">
                        <div id="character-status">Feeling bored...</div>
                    </div>
                    <div class="npc-container" id="npc-container"></div>
                </div>
                
                <div id="actions-panel">
                    <h3>ACTIONS</h3>
                    <div id="actions-list"></div>
                </div>
            </div>
            
            <!-- Location Navigation -->
            <div id="location-nav">
                <button class="loc-btn active" onclick="changeLocation('classroom')">üìö Classroom</button>
                <button class="loc-btn" onclick="changeLocation('hallway')">üö∂ Hallway</button>
                <button class="loc-btn" onclick="changeLocation('computerlab')">üíª Computer Lab</button>
                <button class="loc-btn" onclick="changeLocation('cafeteria')">üçî Cafeteria</button>
                <button class="loc-btn" onclick="changeLocation('bathroom')">üöΩ Bathroom</button>
            </div>
            
            <!-- Event Log -->
            <div id="event-bar">
                <div id="event-log"></div>
            </div>
        </div>
        
        <!-- Mini Game Overlay -->
        <div id="mini-game-overlay">
            <h2 id="mini-game-title">üéÆ SECURCENTRIX 81 üéÆ</h2>
            <canvas id="mini-game-canvas" width="600" height="400"></canvas>
            <div id="mini-game-ui">
                <span class="mini-stat">SCORE: <span id="mini-score">0</span></span>
                <span class="mini-stat">LEVEL: <span id="mini-level">1</span></span>
                <span class="mini-stat">LIVES: <span id="mini-lives">3</span></span>
            </div>
            <p style="color: #00ff88; margin-top: 10px; font-size: 0.8rem;">Arrow keys to move, Space to shoot!</p>
            <button id="exit-mini-game" onclick="exitMiniGame()">EXIT GAME</button>
        </div>
        
        <!-- Dialog Box -->
        <div id="dialog-box">
            <p id="dialog-text"></p>
            <div id="dialog-buttons"></div>
        </div>
        
        <!-- Notification -->
        <div id="notification"></div>
        
        <!-- Game Over Screen -->
        <div id="game-over-screen">
            <h2 id="game-over-title">GAME OVER</h2>
            <p id="game-over-message"></p>
            <p id="final-stats"></p>
            <button class="menu-btn" onclick="location.reload()">PLAY AGAIN</button>
        </div>
    </div>
    
    <script>
        // Game State
        const game = {
            day: 1,
            dayName: 'Monday',
            timeOfDay: 'morning',
            location: 'classroom',
            stats: {
                grades: 30,
                energy: 100,
                fun: 50,
                reputation: 50
            },
            flags: {
                playedToday: false,
                studiedToday: false,
                annoyedToday: 0,
                gotBulliedToday: false
            },
            achievements: [],
            events: []
        };
        
        const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
        
        const locations = {
            classroom: {
                name: 'üìö CLASSROOM',
                bg: '#2d3436',
                npcs: ['teacher', 'nerd', 'sleeper']
            },
            hallway: {
                name: 'üö∂ HALLWAY',
                bg: '#636e72',
                npcs: ['bully', 'popular', 'janitor']
            },
            computerlab: {
                name: 'üíª COMPUTER LAB',
                bg: '#0a0a0f',
                npcs: ['gamer', 'techie']
            },
            cafeteria: {
                name: 'üçî CAFETERIA',
                bg: '#d63031',
                npcs: ['lunchLady', 'loner']
            },
            bathroom: {
                name: 'üöΩ BATHROOM',
                bg: '#00b894',
                npcs: []
            }
        };
        
        const npcs = {
            teacher: { name: 'Mr. Strict', emoji: 'üë®‚Äçüè´', mood: 'annoyed' },
            nerd: { name: 'Nerdy Nathan', emoji: 'ü§ì', mood: 'helpful' },
            sleeper: { name: 'Sleepy Steve', emoji: 'üò¥', mood: 'tired' },
            bully: { name: 'Big Brad', emoji: 'üò§', mood: 'aggressive' },
            popular: { name: 'Cool Casey', emoji: 'üòé', mood: 'dismissive' },
            janitor: { name: 'Old Joe', emoji: 'üßπ', mood: 'wise' },
            gamer: { name: 'Gamer Greg', emoji: 'üéÆ', mood: 'excited' },
            techie: { name: 'Tech Tina', emoji: 'üíª', mood: 'busy' },
            lunchLady: { name: 'Lunch Lady', emoji: 'üë©‚Äçüç≥', mood: 'grumpy' },
            loner: { name: 'Quiet Quinn', emoji: 'üò∂', mood: 'shy' }
        };
        
        const actions = {
            classroom: [
                { id: 'study', name: 'üìñ Pretend to Study', cost: 'Energy -10', effect: () => modifyStats({grades: 5, energy: -10, fun: -5}) },
                { id: 'sleep', name: 'üò¥ Sleep in Class', cost: 'Energy +20, Grades -5', effect: () => modifyStats({energy: 20, grades: -5, reputation: -5}) },
                { id: 'annoy', name: 'üòà Annoy Classmates', cost: 'Fun +15, Rep -10', effect: () => annoyClassmates() },
                { id: 'daydream', name: 'üí≠ Daydream', cost: 'Fun +5', effect: () => modifyStats({fun: 5}) }
            ],
            hallway: [
                { id: 'wander', name: 'üö∂ Wander Around', cost: 'Energy -5', effect: () => wanderHallway() },
                { id: 'prank', name: 'üé≠ Pull a Prank', cost: 'Fun +20, Rep -15', effect: () => pullPrank() },
                { id: 'hide', name: 'üôà Hide from Bully', cost: 'Rep -5', effect: () => modifyStats({reputation: -5}) },
                { id: 'socialize', name: 'üó£Ô∏è Try to Socialize', cost: 'Energy -10', effect: () => trySocialize() }
            ],
            computerlab: [
                { id: 'securcentrix', name: 'üéÆ Play SecurCentrix!', cost: 'Fun +30, Energy -20', effect: () => playSecurCentrix() },
                { id: 'browse', name: 'üåê Browse Memes', cost: 'Fun +10', effect: () => modifyStats({fun: 10, grades: -2}) },
                { id: 'homework', name: 'üìù Do Homework', cost: 'Grades +10, Fun -10', effect: () => modifyStats({grades: 10, fun: -10, energy: -15}) },
                { id: 'distract', name: 'üîä Distract Others', cost: 'Fun +15, Rep -20', effect: () => distractOthers() }
            ],
            cafeteria: [
                { id: 'eat', name: 'üçî Eat Lunch', cost: 'Energy +25', effect: () => modifyStats({energy: 25}) },
                { id: 'foodfight', name: 'üçï Start Food Fight', cost: 'Fun +25, Rep -30', effect: () => startFoodFight() },
                { id: 'sitwith', name: 'üë• Sit with Someone', cost: 'Random Effect', effect: () => sitWithSomeone() },
                { id: 'steal', name: 'ü•™ Steal Food', cost: 'Energy +15, Rep -10', effect: () => stealFood() }
            ],
            bathroom: [
                { id: 'hide', name: 'üöΩ Hide from Problems', cost: 'Stress Relief', effect: () => modifyStats({fun: 5, energy: 5}) },
                { id: 'mirror', name: 'ü™û Practice Comebacks', cost: 'Rep +5', effect: () => modifyStats({reputation: 5}) },
                { id: 'graffiti', name: 'üñäÔ∏è Draw Graffiti', cost: 'Fun +20, Risk!', effect: () => drawGraffiti() },
                { id: 'skip', name: '‚è≠Ô∏è Skip Class Here', cost: 'Fun +10, Grades -10', effect: () => modifyStats({fun: 10, grades: -10}) }
            ]
        };
        
        // Start Game
        function startGame() {
            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            addEvent('Welcome to your life as Saharsh! Try to survive the school week...', 'neutral');
            updateUI();
            randomEvent();
        }
        
        // Update UI
        function updateUI() {
            document.getElementById('grades-fill').style.width = game.stats.grades + '%';
            document.getElementById('energy-fill').style.width = game.stats.energy + '%';
            document.getElementById('fun-fill').style.width = game.stats.fun + '%';
            document.getElementById('rep-fill').style.width = game.stats.reputation + '%';
            
            document.getElementById('day-display').textContent = `DAY ${game.day} - ${game.dayName.toUpperCase()}`;
            document.getElementById('location-name').textContent = locations[game.location].name;
            
            updateStatus();
            updateActions();
            updateNPCs();
            updateLocationButtons();
            
            checkGameState();
        }
        
        function updateStatus() {
            let status = '';
            if (game.stats.energy < 20) status = 'üò© Exhausted...';
            else if (game.stats.fun < 20) status = 'üòê Super bored...';
            else if (game.stats.grades < 20) status = 'üò∞ Failing badly...';
            else if (game.stats.reputation < 20) status = 'üò¢ Nobody likes me...';
            else if (game.stats.fun > 80) status = 'üòÑ Having a blast!';
            else if (game.stats.grades > 70) status = 'ü§î Wait, am I studying?';
            else status = 'üòè Just vibing...';
            
            document.getElementById('character-status').textContent = status;
        }
        
        function updateActions() {
            const container = document.getElementById('actions-list');
            container.innerHTML = '';
            
            const locationActions = actions[game.location];
            locationActions.forEach(action => {
                const btn = document.createElement('button');
                btn.className = 'action-btn';
                btn.innerHTML = `${action.name}<span class="action-cost">${action.cost}</span>`;
                btn.onclick = () => {
                    action.effect();
                    advanceTime();
                };
                btn.disabled = game.stats.energy <= 0;
                container.appendChild(btn);
            });
        }
        
        function updateNPCs() {
            const container = document.getElementById('npc-container');
            container.innerHTML = '';
            
            const locationNPCs = locations[game.location].npcs;
            locationNPCs.forEach(npcId => {
                const npc = npcs[npcId];
                const div = document.createElement('div');
                div.className = 'npc';
                div.innerHTML = `
                    <div class="npc-avatar">${npc.emoji}</div>
                    <div class="npc-name">${npc.name}</div>
                `;
                div.onclick = () => interactWithNPC(npcId);
                container.appendChild(div);
            });
        }
        
        function updateLocationButtons() {
            document.querySelectorAll('.loc-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(game.location.replace('computerlab', 'computer'))) {
                    btn.classList.add('active');
                }
            });
        }
        
        // Modify Stats
        function modifyStats(changes) {
            for (let stat in changes) {
                game.stats[stat] = Math.max(0, Math.min(100, game.stats[stat] + changes[stat]));
            }
            updateUI();
        }
        
        // Add Event
        function addEvent(text, type = 'neutral') {
            const log = document.getElementById('event-log');
            const entry = document.createElement('div');
            entry.className = `event-entry event-${type}`;
            entry.textContent = `[${game.dayName}] ${text}`;
            log.insertBefore(entry, log.firstChild);
            
            if (log.children.length > 20) {
                log.removeChild(log.lastChild);
            }
        }
        
        // Show Notification
        function showNotification(text) {
            const notif = document.getElementById('notification');
            notif.textContent = text;
            notif.style.display = 'block';
            setTimeout(() => notif.style.display = 'none', 2000);
        }
        
        // Change Location
        function changeLocation(loc) {
            if (game.stats.energy < 5) {
                showNotification('Too tired to move!');
                return;
            }
            game.location = loc;
            game.stats.energy -= 3;
            addEvent(`Walked to the ${locations[loc].name}`, 'neutral');
            updateUI();
            
            // Random hallway bully encounter
            if (loc === 'hallway' && Math.random() < 0.4 && !game.flags.gotBulliedToday) {
                setTimeout(() => bullyEncounter(), 500);
            }
        }
        
        // Special Actions
        function annoyClassmates() {
            game.flags.annoyedToday++;
            const responses = [
                "You poke the person in front of you. They're furious!",
                "You make annoying sounds. Everyone glares at you.",
                "You throw paper airplanes. The teacher notices!",
                "You whisper loudly. People are not amused.",
                "You tap your pencil obnoxiously. Classic!"
            ];
            addEvent(responses[Math.floor(Math.random() * responses.length)], 'neutral');
            modifyStats({fun: 15, reputation: -10});
            
            if (game.flags.annoyedToday >= 3) {
                addEvent("Teacher: 'THAT'S IT! Principal's office!'", 'bad');
                modifyStats({grades: -15, reputation: -10});
            }
        }
        
        function playSecurCentrix() {
            game.flags.playedToday = true;
            document.getElementById('mini-game-overlay').style.display = 'flex';
            startMiniGame();
        }
        
        function pullPrank() {
            const success = Math.random() > 0.4;
            if (success) {
                addEvent("Your prank was legendary! Everyone's talking about it.", 'good');
                modifyStats({fun: 25, reputation: 10});
            } else {
                addEvent("Prank failed! You got caught red-handed.", 'bad');
                modifyStats({fun: -10, reputation: -20, grades: -10});
            }
        }
        
        function distractOthers() {
            addEvent("You blast loud music from the computer. The lab goes crazy!", 'neutral');
            modifyStats({fun: 20, reputation: -15});
            
            if (Math.random() < 0.3) {
                addEvent("The IT teacher bans you from computers for the day!", 'bad');
            }
        }
        
        function startFoodFight() {
            addEvent("FOOD FIGHT!!! The cafeteria erupts in chaos!", 'neutral');
            modifyStats({fun: 30, reputation: -25, energy: -15});
            
            if (Math.random() < 0.5) {
                addEvent("You got detention! Worth it though.", 'bad');
                modifyStats({grades: -10});
            }
        }
        
        function sitWithSomeone() {
            const outcomes = [
                { text: "You sat with the cool kids. They ignored you.", stats: {reputation: -5} },
                { text: "You sat with the nerds. They helped with homework!", stats: {grades: 10, fun: -5} },
                { text: "You sat alone. It was peaceful.", stats: {energy: 10} },
                { text: "Someone actually talked to you! Friendship+", stats: {reputation: 15, fun: 10} }
            ];
            const outcome = outcomes[Math.floor(Math.random() * outcomes.length)];
            addEvent(outcome.text, outcome.stats.reputation > 0 ? 'good' : 'neutral');
            modifyStats(outcome.stats);
        }
        
        function stealFood() {
            if (Math.random() < 0.6) {
                addEvent("Successfully stole someone's cookies!", 'good');
                modifyStats({energy: 15, reputation: -5});
            } else {
                addEvent("Got caught stealing! Lunch lady is angry!", 'bad');
                modifyStats({reputation: -20});
            }
        }
        
        function drawGraffiti() {
            addEvent("Drew 'Saharsh was here' on the wall.", 'neutral');
            modifyStats({fun: 20});
            
            if (Math.random() < 0.3) {
                addEvent("Janitor caught you! Parents called!", 'bad');
                modifyStats({reputation: -30, grades: -15});
            }
        }
        
        function wanderHallway() {
            const events = [
                "Found a dollar on the ground!",
                "Saw two kids fighting. Interesting.",
                "Avoided the teacher on hall duty.",
                "Made eye contact with your crush. Awkward."
            ];
            addEvent(events[Math.floor(Math.random() * events.length)], 'neutral');
            modifyStats({energy: -5});
        }
        
        function trySocialize() {
            if (Math.random() < 0.3) {
                addEvent("Someone actually laughed at your joke!", 'good');
                modifyStats({reputation: 15, fun: 10, energy: -10});
            } else {
                addEvent("You tried talking to someone. They walked away.", 'bad');
                modifyStats({reputation: -5, fun: -5, energy: -10});
            }
        }
        
        // NPC Interactions
        function interactWithNPC(npcId) {
            const npc = npcs[npcId];
            let dialog = '';
            let buttons = [];
            
            switch(npcId) {
                case 'teacher':
                    dialog = `${npc.emoji} Mr. Strict: "Saharsh! Are you paying attention or playing games again?!"`;
                    buttons = [
                        { text: "Yes sir, definitely studying!", action: () => { addEvent("Teacher doesn't believe you.", 'bad'); modifyStats({grades: -5}); } },
                        { text: "Actually, no.", action: () => { addEvent("At least you're honest. Detention.", 'neutral'); modifyStats({reputation: 5, grades: -10}); } }
                    ];
                    break;
                case 'nerd':
                    dialog = `${npc.emoji} Nerdy Nathan: "Hey Saharsh, need help with the homework?"`;
                    buttons = [
                        { text: "Yes please!", action: () => { addEvent("Nathan explains the material.", 'good'); modifyStats({grades: 15, energy: -5}); } },
                        { text: "Nerd.", action: () => { addEvent("Nathan looks hurt. Ouch.", 'bad'); modifyStats({reputation: -10, fun: 5}); } }
                    ];
                    break;
                case 'bully':
                    dialog = `${npc.emoji} Big Brad: "Hey loser! Give me your lunch money!"`;
                    buttons = [
                        { text: "Here, take it...", action: () => { addEvent("Brad takes your money. You're hungry now.", 'bad'); modifyStats({energy: -20, reputation: -10}); } },
                        { text: "Make me!", action: () => { 
                            if (Math.random() < 0.3) {
                                addEvent("You stood up to Brad! He backs off!", 'good'); 
                                modifyStats({reputation: 20}); 
                            } else {
                                addEvent("Brad shoves you into a locker.", 'bad');
                                modifyStats({energy: -25, reputation: -15, fun: -20});
                            }
                        }}
                    ];
                    break;
                case 'gamer':
                    dialog = `${npc.emoji} Gamer Greg: "Dude! Wanna play SecurCentrix? I heard you're pretty good!"`;
                    buttons = [
                        { text: "Let's go!", action: () => playSecurCentrix() },
                        { text: "Maybe later", action: () => addEvent("Greg shrugs and continues playing.", 'neutral') }
                    ];
                    break;
                case 'popular':
                    dialog = `${npc.emoji} Cool Casey: *looks at you* "Do I know you?"`;
                    buttons = [
                        { text: "We have 3 classes together...", action: () => { addEvent("Casey: 'Oh. Okay.' Walks away.", 'bad'); modifyStats({reputation: -5}); } },
                        { text: "You will.", action: () => { addEvent("Casey looks confused but slightly impressed.", 'neutral'); modifyStats({reputation: 5}); } }
                    ];
                    break;
                default:
                    dialog = `${npc.emoji} ${npc.name}: "Hey there."`;
                    buttons = [{ text: "Hi!", action: () => addEvent(`You waved at ${npc.name}.`, 'neutral') }];
            }
            
            showDialog(dialog, buttons);
        }
        
        function showDialog(text, buttons) {
            const dialogBox = document.getElementById('dialog-box');
            document.getElementById('dialog-text').textContent = text;
            
            const btnContainer = document.getElementById('dialog-buttons');
            btnContainer.innerHTML = '';
            
            buttons.forEach((btn, i) => {
                const button = document.createElement('button');
                button.className = 'dialog-btn' + (i === 1 ? ' bad' : '');
                button.textContent = btn.text;
                button.onclick = () => {
                    btn.action();
                    dialogBox.style.display = 'none';
                    updateUI();
                };
                btnContainer.appendChild(button);
            });
            
            dialogBox.style.display = 'block';
        }
        
        // Random Events
        function randomEvent() {
            if (Math.random() < 0.3) {
                const events = [
                    { text: "Pop quiz! You weren't ready.", stats: {grades: -10}, type: 'bad' },
                    { text: "Found $5 in your old jacket!", stats: {fun: 10}, type: 'good' },
                    { text: "Someone complimented your shoes.", stats: {reputation: 5}, type: 'good' },
                    { text: "Tripped in the hallway. Everyone saw.", stats: {reputation: -10}, type: 'bad' },
                    { text: "Free pizza day in the cafeteria!", stats: {energy: 20, fun: 10}, type: 'good' },
                    { text: "Your crush walked by. You froze.", stats: {fun: -5}, type: 'neutral' }
                ];
                const event = events[Math.floor(Math.random() * events.length)];
                addEvent(event.text, event.type);
                modifyStats(event.stats);
            }
        }
        
        function bullyEncounter() {
            if (game.stats.reputation < 30) {
                game.flags.gotBulliedToday = true;
                addEvent("Big Brad spotted you! 'Hey LOSER!'", 'bad');
                showDialog("üò§ Big Brad blocks your path: 'Where do you think YOU'RE going?'", [
                    { text: "Run away!", action: () => { addEvent("You escaped! But lost dignity.", 'neutral'); modifyStats({reputation: -15, energy: -10}); } },
                    { text: "Face him", action: () => {
                        if (Math.random() < 0.2) {
                            addEvent("A teacher appeared! Brad leaves.", 'good');
                        } else {
                            addEvent("Brad gave you a wedgie. Classic.", 'bad');
                            modifyStats({reputation: -20, fun: -20, energy: -15});
                        }
                    }}
                ]);
            }
        }
        
        // Advance Time
        function advanceTime() {
            if (game.timeOfDay === 'morning') {
                game.timeOfDay = 'afternoon';
            } else {
                game.timeOfDay = 'morning';
                game.day++;
                game.flags = { playedToday: false, studiedToday: false, annoyedToday: 0, gotBulliedToday: false };
                
                if (game.day > 5) {
                    endWeek();
                    return;
                }
                
                game.dayName = days[game.day - 1];
                addEvent(`--- NEW DAY: ${game.dayName} ---`, 'neutral');
                
                // Overnight recovery
                modifyStats({energy: 50});
                
                // Grades decay if not studying
                if (!game.flags.studiedToday) {
                    modifyStats({grades: -5});
                }
            }
            
            randomEvent();
            updateUI();
        }
        
        // Mini Game - SecurCentrix
        let miniGame = {
            player: { x: 300, y: 350, width: 40, height: 30 },
            bullets: [],
            enemies: [],
            score: 0,
            level: 1,
            lives: 3,
            running: false
        };
        
        let miniGameKeys = {};
        
        function startMiniGame() {
            const canvas = document.getElementById('mini-game-canvas');
            const ctx = canvas.getContext('2d');
            
            miniGame = {
                player: { x: 300, y: 350, width: 40, height: 30 },
                bullets: [],
                enemies: [],
                score: 0,
                level: 1,
                lives: 3,
                running: true
            };
            
            // Spawn initial enemies
            spawnEnemies();
            
            document.addEventListener('keydown', miniGameKeyDown);
            document.addEventListener('keyup', miniGameKeyUp);
            
            function miniGameLoop() {
                if (!miniGame.running) return;
                
                ctx.fillStyle = '#0a0a0f';
                ctx.fillRect(0, 0, 600, 400);
                
                // Draw stars
                ctx.fillStyle = '#ffffff';
                for (let i = 0; i < 50; i++) {
                    ctx.fillRect(
                        (i * 37 + performance.now() / 50) % 600,
                        (i * 53) % 400,
                        2, 2
                    );
                }
                
                // Move player
                if (miniGameKeys['ArrowLeft']) miniGame.player.x = Math.max(0, miniGame.player.x - 8);
                if (miniGameKeys['ArrowRight']) miniGame.player.x = Math.min(560, miniGame.player.x + 8);
                
                // Draw player (spaceship)
                ctx.fillStyle = '#00ff88';
                ctx.beginPath();
                ctx.moveTo(miniGame.player.x + 20, miniGame.player.y);
                ctx.lineTo(miniGame.player.x, miniGame.player.y + 30);
                ctx.lineTo(miniGame.player.x + 40, miniGame.player.y + 30);
                ctx.closePath();
                ctx.fill();
                
                // Draw engine glow
                ctx.fillStyle = '#ff6b6b';
                ctx.fillRect(miniGame.player.x + 15, miniGame.player.y + 30, 10, 5 + Math.random() * 5);
                
                // Update bullets
                miniGame.bullets.forEach((bullet, i) => {
                    bullet.y -= 10;
                    ctx.fillStyle = '#ffff00';
                    ctx.fillRect(bullet.x, bullet.y, 4, 10);
                    
                    if (bullet.y < 0) miniGame.bullets.splice(i, 1);
                });
                
                // Update enemies
                miniGame.enemies.forEach((enemy, ei) => {
                    enemy.y += enemy.speed;
                    enemy.x += Math.sin(enemy.y / 30) * 2;
                    
                    // Draw enemy
                    ctx.fillStyle = enemy.color;
                    ctx.beginPath();
                    ctx.arc(enemy.x, enemy.y, enemy.size, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw enemy eyes
                    ctx.fillStyle = '#fff';
                    ctx.beginPath();
                    ctx.arc(enemy.x - 5, enemy.y - 3, 4, 0, Math.PI * 2);
                    ctx.arc(enemy.x + 5, enemy.y - 3, 4, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Check bullet collision
                    miniGame.bullets.forEach((bullet, bi) => {
                        if (Math.abs(bullet.x - enemy.x) < enemy.size &&
                            Math.abs(bullet.y - enemy.y) < enemy.size) {
                            miniGame.bullets.splice(bi, 1);
                            miniGame.enemies.splice(ei, 1);
                            miniGame.score += 100;
                            document.getElementById('mini-score').textContent = miniGame.score;
                        }
                    });
                    
                    // Check player collision
                    if (enemy.y > 350 && Math.abs(enemy.x - miniGame.player.x - 20) < 30) {
                        miniGame.lives--;
                        document.getElementById('mini-lives').textContent = miniGame.lives;
                        miniGame.enemies.splice(ei, 1);
                        
                        if (miniGame.lives <= 0) {
                            endMiniGame();
                            return;
                        }
                    }
                    
                    // Enemy passed
                    if (enemy.y > 420) {
                        miniGame.enemies.splice(ei, 1);
                    }
                });
                
                // Check level up
                if (miniGame.enemies.length === 0) {
                    miniGame.level++;
                    document.getElementById('mini-level').textContent = miniGame.level;
                    spawnEnemies();
                }
                
                // Draw UI
                ctx.fillStyle = '#00ff88';
                ctx.font = '14px "Press Start 2P"';
                ctx.fillText('SECURCENTRIX 81', 200, 30);
                
                requestAnimationFrame(miniGameLoop);
            }
            
            miniGameLoop();
        }
        
        function spawnEnemies() {
            const count = 5 + miniGame.level * 2;
            const colors = ['#ff6b6b', '#a55eea', '#feca57', '#54a0ff', '#ff9ff3'];
            
            for (let i = 0; i < count; i++) {
                miniGame.enemies.push({
                    x: 50 + Math.random() * 500,
                    y: -50 - Math.random() * 200,
                    size: 15 + Math.random() * 10,
                    speed: 1 + Math.random() * 2 + miniGame.level * 0.3,
                    color: colors[Math.floor(Math.random() * colors.length)]
                });
            }
        }
        
        function miniGameKeyDown(e) {
            miniGameKeys[e.code] = true;
            if (e.code === 'Space' && miniGame.running) {
                miniGame.bullets.push({
                    x: miniGame.player.x + 18,
                    y: miniGame.player.y
                });
            }
            if (['ArrowLeft', 'ArrowRight', 'Space'].includes(e.code)) {
                e.preventDefault();
            }
        }
        
        function miniGameKeyUp(e) {
            miniGameKeys[e.code] = false;
        }
        
        function endMiniGame() {
            miniGame.running = false;
            document.removeEventListener('keydown', miniGameKeyDown);
            document.removeEventListener('keyup', miniGameKeyUp);
            
            setTimeout(() => {
                exitMiniGame();
                const bonus = Math.floor(miniGame.score / 100);
                addEvent(`SecurCentrix session over! Score: ${miniGame.score}. You feel ${bonus > 5 ? 'amazing' : 'satisfied'}.`, 'good');
                modifyStats({fun: 20 + bonus, energy: -15});
            }, 1000);
        }
        
        function exitMiniGame() {
            miniGame.running = false;
            document.removeEventListener('keydown', miniGameKeyDown);
            document.removeEventListener('keyup', miniGameKeyUp);
            document.getElementById('mini-game-overlay').style.display = 'none';
            updateUI();
        }
        
        // Check Game State
        function checkGameState() {
            if (game.stats.grades <= 0) {
                endGame('expelled', "Your grades hit 0%! You've been expelled from school!");
            } else if (game.stats.energy <= 0) {
                endGame('exhausted', "You collapsed from exhaustion! Mom picked you up.");
            } else if (game.stats.reputation <= 0) {
                endGame('outcast', "Everyone hates you now. You transferred schools in shame.");
            } else if (game.stats.fun <= 0) {
                endGame('depressed', "You lost all will to continue. Game over, man.");
            }
        }
        
        function endWeek() {
            let title, message;
            const avgStats = (game.stats.grades + game.stats.energy + game.stats.fun + game.stats.reputation) / 4;
            
            if (avgStats > 70) {
                title = "üéâ LEGENDARY WEEK!";
                message = "Against all odds, you survived AND thrived! Saharsh is now a school legend!";
            } else if (avgStats > 50) {
                title = "‚ú® SURVIVED!";
                message = "You made it through the week! Not great, not terrible. Classic Saharsh.";
            } else if (avgStats > 30) {
                title = "üòÖ BARELY MADE IT";
                message = "The week is over... somehow. Your parents are 'concerned'.";
            } else {
                title = "üíÄ ROUGH WEEK";
                message = "That was painful to watch. At least the weekend is here.";
            }
            
            endGame('survived', message, title);
        }
        
        function endGame(reason, message, customTitle = null) {
            const screen = document.getElementById('game-over-screen');
            document.getElementById('game-over-title').textContent = customTitle || (reason === 'survived' ? 'üèÜ WEEK COMPLETE!' : 'üíÄ GAME OVER');
            document.getElementById('game-over-title').style.color = reason === 'survived' ? '#1dd1a1' : '#ff6b6b';
            document.getElementById('game-over-message').textContent = message;
            document.getElementById('final-stats').innerHTML = `
                Final Stats:<br>
                üìö Grades: ${game.stats.grades}% | 
                ‚ö° Energy: ${game.stats.energy}% | 
                üéÆ Fun: ${game.stats.fun}% | 
                ‚≠ê Reputation: ${game.stats.reputation}%<br>
                Days Survived: ${game.day}/5
            `;
            screen.style.display = 'flex';
        }
    </script>
</body>
</html>
